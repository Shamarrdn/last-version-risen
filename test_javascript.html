<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø§Ø®ØªØ¨Ø§Ø± JavaScript</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .test-section {
            margin: 20px 0;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        .success {
            background-color: #d4edda;
            border-color: #c3e6cb;
            color: #155724;
        }
        .error {
            background-color: #f8d7da;
            border-color: #f5c6cb;
            color: #721c24;
        }
        button {
            background-color: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background-color: #0056b3;
        }
        #console-output {
            background-color: #f8f9fa;
            border: 1px solid #dee2e6;
            padding: 10px;
            border-radius: 5px;
            font-family: monospace;
            white-space: pre-wrap;
            max-height: 300px;
            overflow-y: auto;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ” Ø§Ø®ØªØ¨Ø§Ø± JavaScript</h1>
        <p>Ù‡Ø°Ø§ Ø§Ù„Ù…Ù„Ù Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„ÙƒÙˆØ¯ JavaScript Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙÙŠ Ø§Ù„Ù†Ù…Ø§Ø°Ø¬</p>
        
        <div class="test-section">
            <h3>1. Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø©</h3>
            <button onclick="testVariables()">Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª</button>
            <div id="variables-result"></div>
        </div>
        
        <div class="test-section">
            <h3>2. Ø§Ø®ØªØ¨Ø§Ø± Ø¯Ø§Ù„Ø© prepareFormData</h3>
            <button onclick="testPrepareFormData()">Ø§Ø®ØªØ¨Ø§Ø± Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</button>
            <div id="prepare-result"></div>
        </div>
        
        <div class="test-section">
            <h3>3. Ø§Ø®ØªØ¨Ø§Ø± Ø¯Ø§Ù„Ø© debugFormData</h3>
            <button onclick="testDebugFormData()">Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„ØªØ´Ø®ÙŠØµ</button>
            <div id="debug-result"></div>
        </div>
        
        <div class="test-section">
            <h3>4. Ø§Ø®ØªØ¨Ø§Ø± DOM Elements</h3>
            <button onclick="testDOMElements()">Ø§Ø®ØªØ¨Ø§Ø± Ø¹Ù†Ø§ØµØ± DOM</button>
            <div id="dom-result"></div>
        </div>
        
        <div class="test-section">
            <h3>5. Console Output</h3>
            <button onclick="clearConsole()">Ù…Ø³Ø­ Console</button>
            <div id="console-output"></div>
        </div>
    </div>

    <script>
        // Ù…Ø­Ø§ÙƒØ§Ø© Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø© ÙÙŠ Ø§Ù„Ù†Ù…Ø§Ø°Ø¬
        let selectedSizes = [];
        let availableSizes = [
            { id: 1, name: 'Ù…Ù‚Ø§Ø³ ØµØºÙŠØ±' },
            { id: 2, name: 'Ù…Ù‚Ø§Ø³ Ù…ØªÙˆØ³Ø·' },
            { id: 3, name: 'Ù…Ù‚Ø§Ø³ ÙƒØ¨ÙŠØ±' }
        ];
        let availableColors = [
            { id: 1, name: 'Ø£Ø­Ù…Ø±', code: '#FF0000' },
            { id: 2, name: 'Ø£Ø²Ø±Ù‚', code: '#0000FF' },
            { id: 3, name: 'Ø£Ø®Ø¶Ø±', code: '#00FF00' }
        ];

        // Ù…Ø­Ø§ÙƒØ§Ø© Ø¯Ø§Ù„Ø© prepareFormData
        function prepareFormData() {
            console.log('ğŸ” [DEBUG] Preparing form data...');
            console.log('Selected sizes:', selectedSizes);
            
            // Ù…Ø­Ø§ÙƒØ§Ø© Ø§Ù„Ù†Ù…ÙˆØ°Ø¬
            const form = document.createElement('form');
            
            // Ø¥Ø¶Ø§ÙØ© Ø¨Ø¹Ø¶ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªØ¬Ø±ÙŠØ¨ÙŠØ©
            selectedSizes = [
                {
                    id: 1,
                    name: 'Ù…Ù‚Ø§Ø³ ØµØºÙŠØ±',
                    colors: [
                        { id: 1, name: 'Ø£Ø­Ù…Ø±', stock: 10, price: 100 }
                    ]
                }
            ];
            
            // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø©
            const oldInputs = form.querySelectorAll('input[name^="selected_sizes"], input[name^="selected_colors"], input[name^="stock["], input[name^="price["]');
            oldInputs.forEach(input => {
                console.log('Removing old input:', input.name, input.value);
                input.remove();
            });
            
            // Ø¬Ù…Ø¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† selectedSizes
            const collectedSizes = new Set();
            const collectedColors = new Set();
            const collectedStockData = {};
            const collectedPriceData = {};
            
            selectedSizes.forEach(size => {
                collectedSizes.add(size.id);
                
                size.colors.forEach(color => {
                    collectedColors.add(color.id);
                    
                    if (!collectedStockData[size.id]) collectedStockData[size.id] = {};
                    if (!collectedPriceData[size.id]) collectedPriceData[size.id] = {};
                    
                    collectedStockData[size.id][color.id] = color.stock;
                    collectedPriceData[size.id][color.id] = color.price;
                });
            });
            
            // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…Ø®ÙÙŠØ©
            Array.from(collectedSizes).forEach(sizeId => {
                const input = document.createElement('input');
                input.type = 'hidden';
                input.name = 'selected_sizes[]';
                input.value = sizeId;
                form.appendChild(input);
                console.log('Added size input:', sizeId);
            });
            
            Array.from(collectedColors).forEach(colorId => {
                const input = document.createElement('input');
                input.type = 'hidden';
                input.name = 'selected_colors[]';
                input.value = colorId;
                form.appendChild(input);
                console.log('Added color input:', colorId);
            });
            
            Object.keys(collectedStockData).forEach(sizeId => {
                Object.keys(collectedStockData[sizeId]).forEach(colorId => {
                    const stockValue = collectedStockData[sizeId][colorId];
                    const priceValue = collectedPriceData[sizeId][colorId];
                    
                    const stockInput = document.createElement('input');
                    stockInput.type = 'hidden';
                    stockInput.name = `stock[${sizeId}][${colorId}]`;
                    stockInput.value = stockValue;
                    form.appendChild(stockInput);
                    
                    const priceInput = document.createElement('input');
                    priceInput.type = 'hidden';
                    priceInput.name = `price[${sizeId}][${colorId}]`;
                    priceInput.value = priceValue;
                    form.appendChild(priceInput);
                });
            });
            
            console.log('âœ… Form data prepared successfully');
            return true;
        }

        // Ù…Ø­Ø§ÙƒØ§Ø© Ø¯Ø§Ù„Ø© debugFormData
        function debugFormData() {
            console.log('ğŸ” === ØªØ´Ø®ÙŠØµ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ===');
            console.log('selectedSizes:', selectedSizes);
            console.log('availableSizes:', availableSizes);
            console.log('availableColors:', availableColors);
            
            const form = document.createElement('form');
            
            // Ø¥Ø¶Ø§ÙØ© Ø¨Ø¹Ø¶ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„ØªØ¬Ø±ÙŠØ¨ÙŠØ©
            const sizeInput = document.createElement('input');
            sizeInput.name = 'selected_sizes[]';
            sizeInput.value = '1';
            form.appendChild(sizeInput);
            
            const colorInput = document.createElement('input');
            colorInput.name = 'selected_colors[]';
            colorInput.value = '1';
            form.appendChild(colorInput);
            
            const stockInput = document.createElement('input');
            stockInput.name = 'stock[1][1]';
            stockInput.value = '10';
            form.appendChild(stockInput);
            
            const selectedSizesInputs = form.querySelectorAll('input[name="selected_sizes[]"]');
            const selectedColorsInputs = form.querySelectorAll('input[name="selected_colors[]"]');
            const stockInputs = form.querySelectorAll('input[name*="stock["]');
            const priceInputs = form.querySelectorAll('input[name*="price["]');
            
            console.log('ğŸ” Inputs found:');
            console.log('- selected_sizes[]:', selectedSizesInputs.length);
            console.log('- selected_colors[]:', selectedColorsInputs.length);
            console.log('- stock inputs:', stockInputs.length);
            console.log('- price inputs:', priceInputs.length);
            
            return {
                sizes: selectedSizesInputs.length,
                colors: selectedColorsInputs.length,
                stock: stockInputs.length,
                price: priceInputs.length
            };
        }

        // Ø¯Ø§Ù„Ø© Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª
        function testVariables() {
            const result = document.getElementById('variables-result');
            try {
                if (typeof selectedSizes !== 'undefined' && Array.isArray(selectedSizes)) {
                    result.innerHTML = '<div class="success">âœ… Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø© Ù…Ø¹Ø±ÙØ© Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­</div>';
                    console.log('âœ… Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø© ØªØ¹Ù…Ù„ Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­');
                } else {
                    result.innerHTML = '<div class="error">âŒ Ù…Ø´ÙƒÙ„Ø© ÙÙŠ ØªØ¹Ø±ÙŠÙ Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø©</div>';
                    console.error('âŒ Ù…Ø´ÙƒÙ„Ø© ÙÙŠ ØªØ¹Ø±ÙŠÙ Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø©');
                }
            } catch (error) {
                result.innerHTML = `<div class="error">âŒ Ø®Ø·Ø£: ${error.message}</div>`;
                console.error('âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª:', error);
            }
        }

        // Ø¯Ø§Ù„Ø© Ø§Ø®ØªØ¨Ø§Ø± prepareFormData
        function testPrepareFormData() {
            const result = document.getElementById('prepare-result');
            try {
                const success = prepareFormData();
                if (success) {
                    result.innerHTML = '<div class="success">âœ… Ø¯Ø§Ù„Ø© prepareFormData ØªØ¹Ù…Ù„ Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­</div>';
                    console.log('âœ… Ø¯Ø§Ù„Ø© prepareFormData ØªØ¹Ù…Ù„ Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­');
                } else {
                    result.innerHTML = '<div class="error">âŒ Ø¯Ø§Ù„Ø© prepareFormData ÙØ´Ù„Øª</div>';
                    console.error('âŒ Ø¯Ø§Ù„Ø© prepareFormData ÙØ´Ù„Øª');
                }
            } catch (error) {
                result.innerHTML = `<div class="error">âŒ Ø®Ø·Ø£: ${error.message}</div>`;
                console.error('âŒ Ø®Ø·Ø£ ÙÙŠ Ø¯Ø§Ù„Ø© prepareFormData:', error);
            }
        }

        // Ø¯Ø§Ù„Ø© Ø§Ø®ØªØ¨Ø§Ø± debugFormData
        function testDebugFormData() {
            const result = document.getElementById('debug-result');
            try {
                const debugResult = debugFormData();
                result.innerHTML = `<div class="success">âœ… Ø¯Ø§Ù„Ø© debugFormData ØªØ¹Ù…Ù„ Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­<br>
                Ø§Ù„Ù†ØªØ§Ø¦Ø¬: Ø§Ù„Ù…Ù‚Ø§Ø³Ø§Øª=${debugResult.sizes}, Ø§Ù„Ø£Ù„ÙˆØ§Ù†=${debugResult.colors}, Ø§Ù„Ù…Ø®Ø²ÙˆÙ†=${debugResult.stock}, Ø§Ù„Ø£Ø³Ø¹Ø§Ø±=${debugResult.price}</div>`;
                console.log('âœ… Ø¯Ø§Ù„Ø© debugFormData ØªØ¹Ù…Ù„ Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­');
            } catch (error) {
                result.innerHTML = `<div class="error">âŒ Ø®Ø·Ø£: ${error.message}</div>`;
                console.error('âŒ Ø®Ø·Ø£ ÙÙŠ Ø¯Ø§Ù„Ø© debugFormData:', error);
            }
        }

        // Ø¯Ø§Ù„Ø© Ø§Ø®ØªØ¨Ø§Ø± DOM Elements
        function testDOMElements() {
            const result = document.getElementById('dom-result');
            try {
                // Ø§Ø®ØªØ¨Ø§Ø± Ø¥Ù†Ø´Ø§Ø¡ Ø¹Ù†Ø§ØµØ± DOM
                const testDiv = document.createElement('div');
                testDiv.className = 'test-element';
                testDiv.innerHTML = 'Ø¹Ù†ØµØ± ØªØ¬Ø±ÙŠØ¨ÙŠ';
                
                const testInput = document.createElement('input');
                testInput.type = 'hidden';
                testInput.name = 'test_input';
                testInput.value = 'test_value';
                
                if (testDiv && testInput) {
                    result.innerHTML = '<div class="success">âœ… Ø¥Ù†Ø´Ø§Ø¡ Ø¹Ù†Ø§ØµØ± DOM ÙŠØ¹Ù…Ù„ Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­</div>';
                    console.log('âœ… Ø¥Ù†Ø´Ø§Ø¡ Ø¹Ù†Ø§ØµØ± DOM ÙŠØ¹Ù…Ù„ Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­');
                } else {
                    result.innerHTML = '<div class="error">âŒ Ù…Ø´ÙƒÙ„Ø© ÙÙŠ Ø¥Ù†Ø´Ø§Ø¡ Ø¹Ù†Ø§ØµØ± DOM</div>';
                    console.error('âŒ Ù…Ø´ÙƒÙ„Ø© ÙÙŠ Ø¥Ù†Ø´Ø§Ø¡ Ø¹Ù†Ø§ØµØ± DOM');
                }
            } catch (error) {
                result.innerHTML = `<div class="error">âŒ Ø®Ø·Ø£: ${error.message}</div>`;
                console.error('âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ø®ØªØ¨Ø§Ø± DOM Elements:', error);
            }
        }

        // Ø¯Ø§Ù„Ø© Ù…Ø³Ø­ Console
        function clearConsole() {
            document.getElementById('console-output').textContent = '';
        }

        // Ø§Ø¹ØªØ±Ø§Ø¶ console.log Ù„Ø¹Ø±Ø¶ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ ÙÙŠ Ø§Ù„ØµÙØ­Ø©
        const originalLog = console.log;
        const originalError = console.error;
        const consoleOutput = document.getElementById('console-output');

        console.log = function(...args) {
            originalLog.apply(console, args);
            consoleOutput.textContent += args.join(' ') + '\n';
        };

        console.error = function(...args) {
            originalError.apply(console, args);
            consoleOutput.textContent += 'âŒ ERROR: ' + args.join(' ') + '\n';
        };

        // ØªØ´ØºÙŠÙ„ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
        document.addEventListener('DOMContentLoaded', function() {
            console.log('ğŸ” Ø¨Ø¯Ø¡ Ø§Ø®ØªØ¨Ø§Ø± JavaScript...');
            console.log('âœ… Ø§Ù„ØµÙØ­Ø© Ù…Ø­Ù…Ù„Ø© Ø¨Ù†Ø¬Ø§Ø­');
            
            // Ø§Ø®ØªØ¨Ø§Ø± ØªÙ„Ù‚Ø§Ø¦ÙŠ Ù„Ù„Ù…ØªØºÙŠØ±Ø§Øª
            setTimeout(() => {
                testVariables();
            }, 500);
        });
    </script>
</body>
</html>
